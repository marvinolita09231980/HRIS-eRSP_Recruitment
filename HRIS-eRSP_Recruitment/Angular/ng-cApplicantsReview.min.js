ng_eRSP_App.controller("cApplicantsReview_Ctrlr",function(n,t,i,r,u){function h(n){return e.elEmpty(f.app_status)?f.Applicant_List_Data_Orig:n.filter(function(n){return n.app_status==f.app_status})}function s(n,t){$("#"+n).val(t);f[n]=t}function a(){e.loading("show");s("employment_type","");f.app_status="1";var n=new Date,t=e.leadingZeroMonth(n.getMonth()),i=n.getFullYear().toString();f.ps.year=i;f.ps.month=t;f.rowLen="10";o.post("../cApplicantsReview/Initialize").then(function(n){n.data.icon=="success"?(f.app_status=n.data.status,f.pageTitle=n.data.pageTitle,f.app_status_list=n.data.app_status_list,f.items=n.data.items,f.budget_year=n.data.budgetyear,f.um=n.data.um,$(document).ready(e.loading("hide")),s("employment_type",n.data.employment_type),s("budget_code",n.data.budget_code),s("item_no",n.data.item_no),s("app_status",n.data.app_status),f.Applicant_List_Data_Orig=n.data.review_list,f.Applicant_List_Data=h(n.data.review_list).refreshTable("Applicant_List_Grid","")):(console.log(n.data.message),$(document).ready(e.loading("hide")))})}var f=t,o=i,e=n,c,l;f.recieved=!1;f.header_title="APPLICANT LIST";f.modal=1;f.rowLen="";f.pageTitle="";f.employment_type="";f.item_no="";f.budget_year=[];f.budget_code="";f.main_edit=!1;f.dtl_edit=!1;f.year=[];f.att_dtl=[];f.position_tbl=[];f.psbcshedlist=[];f.app_status_list=[];f.Applicant_List_Data_Orig=[];f.budget_year=[];f.items=[];f.um={};f.fd={};f.wx={};f.ld={};f.el={};f.ed={};f.app_ctrl_nbr="";f.month=[{id:"01",text:"January"},{id:"02",text:"February"},{id:"03",text:"March"},{id:"04",text:"April"},{id:"05",text:"May"},{id:"06",text:"June"},{id:"07",text:"July"},{id:"08",text:"August"},{id:"09",text:"September"},{id:"10",text:"October"},{id:"11",text:"November"},{id:"12",text:"December"},];f.year=e.RetrieveYear();f.ps={app_ctrl_nbr:"",year:"",month:"",psb_ctrl_nbr:"",psb_date:"",employment_type:"",employment_type_descr:"",remarks_details:""};f.app_review={app_ctrl_nbr:"",app_ctrl_nbr_disp:"",employment_type:"",budget_code:"",position_code:"",item_no:"",department_code:"",exam_type_descr:"",score_rendered:"",exam_date:""};f.status=[{id:"RC",text:"Received"},{id:"WS",text:"Waiting List"},{id:"SL",text:"Short List"},{id:"PS",text:"PSB Screened"},{id:"AP",text:"Approved"}];f.review_status=[{id:"DS",text:"Disapproved"},{id:"PS",text:"PSB Screening"},{id:"JH",text:"JO Hiring"},{id:"FL",text:"For Filing"}];f.AT=[{id:"",text:""},{id:"JO",text:"Job Order"},{id:"RE",text:"Permanent"},{id:"CE",text:"CASUAL"}];f.alphabet_list=[{alpha_name:"A"},{alpha_name:"B"},{alpha_name:"C"},{alpha_name:"D"},{alpha_name:"E"},{alpha_name:"F"},{alpha_name:"G"},{alpha_name:"H"},{alpha_name:"I"},{alpha_name:"J"},{alpha_name:"K"},{alpha_name:"L"},{alpha_name:"M"},{alpha_name:"N"},{alpha_name:"O"},{alpha_name:"P"},{alpha_name:"Q"},{alpha_name:"R"},{alpha_name:"S"},{alpha_name:"T"},{alpha_name:"U"},{alpha_name:"V"},{alpha_name:"W"},{alpha_name:"X"},{alpha_name:"Y"},{alpha_name:"Z"}];f.svc=[{id:!1,text:"No"},{id:!0,text:"Yes"}];c=function(n){f.Applicant_List_Data=n;f.Applicant_List_Table=$("#Applicant_List_Grid").dataTable({data:f.Applicant_List_Data,sDom:'rt<"bottom"p>',pageLength:10,columns:[{mData:"app_ctrl_nbr_disp",mRender:function(n){return"<span class='text-center btn-block'>"+n+"<\/span>"}},{mData:"applicant_name",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"applied_dttm",mRender:function(n){return"<span class='text-center btn-block'>"+n+"<\/span>"}},{mData:"position_long_title",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"employment_type_descr",mRender:function(n){return"<span class='text-center btn-block'>"+n+"<\/span>"}},{mData:"app_status_short_descr",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"app_status",bSortable:!1,mRender:function(n,t,i,r){return'<center><div class="btn-group action-btn"><button type="button"  class="btn btn-warning btn-sm action" data-toggle="tab" data-toggle="tooltip" data-placement="top" title="Review Application"  ng-click="appl_review('+r.row+')" >  <i class="fa fa-plus"><\/i><\/button ><button type="button"  class="btn btn-success btn-sm action" data-toggle="tab" data-toggle="tooltip" data-placement="top" title="Rate Quality Standards" ng-click="qs_btn_rate('+r.row+')" >  <i class="fa fa-star"><\/i><\/button ><button type="button"  class="btn btn-info btn-sm action" data-toggle="tab" data-toggle="tooltip" data-placement="top" title="Add Exam Result" ng-click="addOtherDetails('+r.row+')" >  <i class="fa fa-trophy"><\/i><\/button ><button type="button"  class="btn btn-danger btn-sm action" data-toggle="tab" data-toggle="tooltip" data-placement="top" title="Send email notification" ng-click="sendEmail('+r.row+')" >  <i class="fa fa-paper-plane"><\/i><\/button ><\/div><\/center>'}}],createdRow:function(n){u(n)(t)}});$("div.toolbar").html("<b>Custom tool bar! Text/images etc.<\/b>")};l=function(n){f.Panel_List_Data=n;f.Panel_List_Table=$("#psb_panel").dataTable({data:f.Panel_List_Data,sDom:'rt<"bottom"p>',pageLength:10,columns:[{mData:"panel_user_id",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"psb_name",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"mbr_role_descr",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}},{mData:"agency",mRender:function(n){return"<span class='text-left btn-block'>"+n+"<\/span>"}}],createdRow:function(n){u(n)(t)}});$("div.toolbar").html("<b>Custom tool bar! Text/images etc.<\/b>")};c([]);l([]);a();f.search_in_list=function(n,t){elEmpty(n)||(f.recieved=!1);$("#"+t).DataTable().search(n).draw()};f.setNumOfRow=function(n,t){$("#"+t).DataTable().page.len(f.rowLen).draw()};f.qs_btn_rate=function(n){var i=f.Applicant_List_Data[n].item_no,t=f.Applicant_List_Data[n].app_ctrl_nbr;o.post("../cApplicantsReview/HasPsbCtrlNbr",{app_ctrl_nbr:t}).then(function(n){n.data.psb_ctrl_nbr_count>0?location.href="cQualificationStandard/Index?app_ctrl_nbr="+t:swal("This application must proceed first to HRMPSB Screening before you can rate Qualification standard, please add this application to HRMPSB Screening!",{icon:"error"})})};f.addOtherDetails=function(n){var t=f.Applicant_List_Data[n];console.log(t);f.app_ctrl_nbr=t.app_ctrl_nbr;o.post("../cApplicantsReview/getReviewDetail",{app_ctrl_nbr:f.app_ctrl_nbr}).then(function(n){if(n.data.dtl_count>0){var i=n.data.dtl;o.post("../cApplicantsReview/getBudgetYear",{budget_code:i[0].budget_code,employment_type:i[0].employment_type}).then(function(n){n.data.icon=="success"&&(f.budget_year=n.data.budget_year,f.position_tbl=n.data.position_tbl,f.app_review=i.populateFields(f.app_review,0),t.app_status=="3"&&(e.DisabledField("exam_type_descr"),e.DisabledField("score_rendered"),e.DisabledField("exam_date"),$("#cal").hide()))});$("#addexamresult").modal("show")}})};$("#addexamresult").on("hidden.bs.modal",function(){e.clearFields(f.app_review)});f.appl_review=function(n){var t=f.Applicant_List_Data[n].position_code,i=f.Applicant_List_Data[n].app_ctrl_nbr;e.elEmpty(t)?swal("This applicant has no define position yet, please assign postion for this specific applicant!",{icon:"error"}):location.href="cApplicantReviewDetail/Index?app_ctrl_nbr="+i};f.selectEmployment=function(n){e.loading("show");f.app_review.budget_code="";o.post("../cApplicantsReview/getBudgetYear",{budget_code:f.app_review.budget_code,employment_type:n}).then(function(n){n.data.icon=="success"?(f.budget_year=n.data.budget_year,f.position_tbl=n.data.position_tbl):console.log(n.data.message);e.loading("hide")})};f.selectEmploymentType=function(n){e.loading("show");o.post("../cApplicantsReview/getBudget_Code",{employment_type:n}).then(function(n){n.data.icon=="success"?(f.budget_year=n.data.budgetyear,s("budget_code",""),s("item_no",""),s("app_status",""),$("#Applicant_List_Grid").dataTable().fnClearTable()):console.log(n.data.message);e.loading("hide")})};f.selectBudgetCode=function(n){e.loading("show");o.post("../cApplicantsReview/getPublicationVacant",{budget_code:n,employment_type:f.employment_type}).then(function(n){n.data.icon=="success"?(f.items=n.data.items,s("item_no",""),f.Applicant_List_Data_Orig=n.data.review_list,f.Applicant_List_Data=h(n.data.review_list).refreshTable("Applicant_List_Grid",""),s("app_status","")):console.log(n.data.message);e.loading("hide")})};f.selectItem=function(n){e.loading("show");o.post("../cApplicantsReview/sp_review_applicant_list",{budget_code:f.budget_code,employment_type:f.employment_type,item_no:n,status:""}).then(function(n){n.data.icon=="success"?(f.Applicant_List_Data_Orig=n.data.review_list,f.Applicant_List_Data=h(n.data.review_list).refreshTable("Applicant_List_Grid",""),s("app_status","")):console.log(n.data.message);e.loading("hide")})};f.selectPosition=function(n){console.log(n);var t=f.position_tbl.filter(function(t){return t.item_no==n})[0];f.app_review.item_no=t.item_no;f.app_review.department_code=t.department_code};f.SaveOtherDetails=function(n){e.loading("show");var t=0,i=$("#exam_date").val(),u=$("#exam_type_descr").val(),r=$("#score_rendered").val();(e.notrequired2("exam_type_descr"),e.notrequired2("score_rendered"),e.notrequired2("exam_date"),e.elEmpty(u)&&(e.required2("exam_type_descr","Required Filed!"),t=t+1),(r=="0"||e.elEmpty(r))&&(e.required2("score_rendered","Required Filed!"),t=t+1),e.elEmpty(i)?(e.required2("exam_date","Required Filed!"),t=t+1):e.valid_date(i,"exam_date")&&(e.required2("exam_date","Invalid date!"),t=t+1),t>0)||(e.spinnerAdd("save_btn","fa fa-save"),o.post("../cApplicantsReview/SaveOtherDetails",{obj:n,examdate:i,examtype:u,scorerendered:r}).then(function(n){n.data.icon=="success"?(e.spinnerRemove("save_btn","fa fa-save"),swal(n.data.message,{icon:n.data.icon}),$("#addexamresult").modal("hide"),e.clearFields(f.app_review)):e.spinnerRemove("save_btn","fa fa-save");e.loading("hide")}))};f.addToPsbSched=function(n){e.loading("show");var i=new Date,r=e.leadingZeroMonth(i.getMonth()),u=i.getFullYear().toString(),t=f.Applicant_List_Data[n],s=t.budget_code;f.item_no=t.item_no;f.ps.year=u;f.ps.month=r;f.ps.app_ctrl_nbr=t.app_ctrl_nbr;f.ps.employment_type=t.employment_type;$("#psb_panel").dataTable().fnClearTable();o.post("../cApplicantsReview/getPsbSchedList",{item_no:f.item_no}).then(function(n){if(n.data.icon=="success"){var t=n.data.itm[0];f.ps.psb_ctrl_nbr=t.psb_ctrl_nbr;f.ps.psb_date=t.psb_date;f.ps.employment_type_descr=t.employment_type_descr;f.ps.remarks_details=t.remarks_details;f.Panel_List_Data=n.data.pnl.refreshTable("psb_panel","");$("#addToPsbSched").modal("show")}else swal(n.data.message,{icon:n.data.icon});e.loading("hide")})};f.selectDate=function(){e.loading("show");$("#Applicant_List_Grid").dataTable().fnClearTable();o.post("../cApplicantsReview/sp_review_applicant_list",{year:f.yr,month:f.mo,status:f.app_status}).then(function(n){n.data.icon=="success"?(f.Applicant_List_Data_Orig=n.data.review_list,f.Applicant_List_Data=n.data.review_list.refreshTable("Applicant_List_Grid","")):console.log(n.data.message);e.loading("hide")})};f.selectSchedule=function(n){e.loading("show");f.ps.employment_type="";f.ps.remarks_details="";$("#psb_panel").dataTable().fnClearTable();var t=f.psbcshedlist.filter(function(t){return t.psb_ctrl_nbr==n});t.length>0&&(f.ps.employment_type=t[0].employment_type,f.ps.remarks_details=t[0].remarks_details);o.post("../cApplicantsReview/getPsbPanelMember",{psb_ctrl_nbr:n}).then(function(n){n.data.icon=="success"?f.Panel_List_Data=n.data.psbcshedmbr.refreshTable("psb_panel",""):console.log(n.data.message);e.loading("hide")})};f.SaveForPsbScreening=function(n){e.loading("show");e.ValidateFields(n)&&o.post("../cApplicantsReview/SaveForPsbSched",{psb_ctrl_nbr:n.psb_ctrl_nbr,app_ctrl_nbr:n.app_ctrl_nbr}).then(function(n){n.data.icon=="success"?(swal(n.data.message,{icon:n.data.icon}),$("#addToPsbSched").modal("hide")):swal(n.data.message,{icon:n.data.icon});e.loading("hide")})};f.selectStatus=function(n){e.loading("show");var t=[];o.post("../cApplicantsReview/sp_review_applicant_list",{budget_code:f.budget_code,employment_type:f.employment_type,item_no:f.item_no,status:n}).then(function(){t=n==""?f.Applicant_List_Data_Orig:f.Applicant_List_Data_Orig.filter(function(t){return t.app_status==n});f.Applicant_List_Data=t.refreshTable("Applicant_List_Grid","");e.loading("hide")})};f.pass_check_box=function(n){e.spinnerAdd("pass"+n,"checkmark");var t=f.Applicant_List_Data[n];if(t.item_in_psb==!1){$("#pass"+n)[0].checked=!1;swal("Applicants item not yet added to PSB screening schedule",{icon:"error"});e.spinnerRemove("pass"+n,"checkmark");return}o.post("../cApplicantsReview/ReviewPass",{item_no:f.item_no,budget_code:f.budget_code,employment_type:f.employment_type,app_ctrl_nbr:t.app_ctrl_nbr,pass:$("#pass"+n)[0].checked}).then(function(t){t.data.icon=="success"?(f.Applicant_List_Data_Orig=t.data.review_list,f.Applicant_List_Data=t.data.review_list.refreshTable("Applicant_List_Grid",""),swal(t.data.message,{icon:t.data.icon}),e.spinnerRemove("pass"+n,"checkmark")):(swal(t.data.message,{icon:t.data.icon}),e.spinnerRemove("pass"+n,"checkmark"))})};f.printScoreSheet=function(n){var t=f.Applicant_List_Data[n],u="Reports",e="Index",i="",s="Crystal_Report",h="inline",r="~/Reports/cryScoreSheet/",c="sp_score_sheet_rpt",l="p_item_no,"+t.item_no+",p_app_ctrl_nbr,"+t.app_ctrl_nbr+",p_app_status,"+t.app_status;i="cryScoreSheet";r=r+""+i+".rpt";o.post("../cApplicantsReview/SetHistoryPage",{}).then(function(){location.href="../"+u+"/"+e+"?ReportName="+i+"&SaveName="+s+"&ReportType="+h+"&ReportPath="+r+"&Sp="+c+","+l})};f.sendEmail=function(n){var t=f.Applicant_List_Data[n];t.email_address!=""?swal({title:"Notify applicant through email?",text:"",icon:"info",buttons:!0,dangerMode:!0}).then(function(n){n&&(e.loading("show"),o.post("../cApplicantsReview/SendToEmail",{email:t.email_address,empl_id:t.empl_id,app_ctrl_nbr:t.app_ctrl_nbr}).then(function(n){swal(n.data.message,{icon:n.data.icon});e.loading("hide")}))}):swal("No email address provided by the applicant!",{icon:"error"})}});ng_eRSP_App.directive("percentage",["commonScript",function(n){return{restrict:"C",link:function(t,i,r){i.on("keyup",function(){var o=0,u=0,f=0,e=i[0].form.id,h=r.id,c=i.val(),s=t[e];f=$("#"+e+' input[name="totalitems"]').val();u=$("#"+e+' input[name="scorerendered"]').val();!n.elEmpty(f)&&!n.elEmpty(u)&&f.length>=u.length&&(parseInt(f)>=parseInt(u)==!0?(o=u*100/f,$("#"+e+' input[name="scoreperc"]').val(o.toFixed(2)),s.score_percentage=o.toFixed(2)):(alert("Total number of items should be higher than score rendered"),$("#"+e+' input[name="scoreperc"]').val(""),s.score_percentage="",i.val(""),s.id=""))})}}}]);ng_eRSP_App.directive("max25",["commonScript",function(){return{restrict:"C",link:function(n,t,i){t.on("keyup",function(){var r=t[0].form.id,e=i.id,u=t.val(),f=n[r];u>25&&(alert("Rating must not be higher than 25"),t.val(""),f.id="")})}}}]);
//# sourceMappingURL=ng-cApplicantsReview.min.js.map
